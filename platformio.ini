; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = esp32dev

[env]
platform = espressif32
framework = arduino
monitor_speed = 115200
board_build.filesystem = littlefs
board_build.partitions = partitions.csv
lib_deps =
    fastled/FastLED @ ^3.7.0
    https://github.com/me-no-dev/ESPAsyncWebServer.git
    https://github.com/me-no-dev/AsyncTCP.git
    bblanchon/ArduinoJson @ ^7.2.0
    knolleary/PubSubClient @ ^2.8.0

[env:esp32dev]
board = esp32dev
upload_speed = 115200
build_flags =
    -DESP32_CLASSIC
    -DLED_DATA_PIN=18
    -DLED_CLOCK_PIN=18
    -DBUTTON_PIN=0          ; Usar botón BOOT en GPIO0 para controles básicos

[env:d1_mini]
platform = espressif8266
board = d1_mini
upload_speed = 921600
build_flags =
    -DLED_DATA_PIN=15       ; D8 en Wemos D1 mini (pide usar este pin)
    -DLED_CLOCK_PIN=14      ; No usado (APA102), pin seguro
lib_deps =
    fastled/FastLED @ ^3.7.0
    https://github.com/me-no-dev/ESPAsyncWebServer.git
    ESPAsyncTCP
    bblanchon/ArduinoJson @ ^7.2.0
    knolleary/PubSubClient @ ^2.8.0
monitor_speed = 115200

[env:esp32-c3-devkitm-1]
board = esp32-c3-devkitm-1
build_flags =
    -DESP32_C3
    -DLED_DATA_PIN=8       ; WS2812 integrado en AI-C3 (GPIO8)
    -DLED_CLOCK_PIN=6

[env:esp32-s3-devkitc-1]
board = esp32-s3-devkitc-1
build_flags =
    -DESP32_S3
    -DLED_DATA_PIN=11
    -DLED_CLOCK_PIN=12

[env:bornhack2024]
board = esp32-c3-devkitm-1
build_flags =
    -DESP32_C3
    -DBORNHACK_BADGE
    -DLED_DATA_PIN=10        ; WS2812 data pin (VERIFICADO desde firmware oficial)
    -DHAS_ACCELEROMETER
    -DACCEL_SDA_PIN=6        ; LIS3DH I2C SDA (VERIFICADO)
    -DACCEL_SCL_PIN=7        ; LIS3DH I2C SCL (VERIFICADO)
    -DBUTTON_PIN=9           ; SELECT button (VERIFICADO)
    -DUP_BUTTON_PIN=2        ; Botón UP (verificado en badge)
    -DDOWN_BUTTON_PIN=8      ; Botón DOWN (verificado en badge)
lib_deps =
    ${env.lib_deps}
    adafruit/Adafruit LIS3DH @ ^1.2.7
    adafruit/Adafruit BusIO @ ^1.16.1
monitor_speed = 115200

; Versión minimal para diagnóstico (sin periféricos, solo Serial)
[env:bornhack2024-minimal]
board = esp32-c3-devkitm-1
build_flags =
    -DESP32_C3
    -DBORNHACK_BADGE
    -DBORNHACK_MINIMAL       ; Desactiva periféricos
    -DLED_DATA_PIN=4         ; Pin seguro temporal
lib_deps =
    ${env.lib_deps}
monitor_speed = 115200

; Versión ultra-minimal - Solo Arduino core, sin dependencias
[env:bornhack2024-ultra]
platform = espressif32
framework = arduino
board = esp32-c3-devkitm-1
build_flags =
    -DESP32_C3
    -DARDUINO_USB_CDC_ON_BOOT=0  ; Deshabilitar USB CDC, usar UART
build_src_filter =
    +<main.cpp>
    -<accelerometer.*>
    -<button.*>
    -<config.h>
    -<effects.*>
    -<ha_integration.*>
    -<image_manager.*>
    -<image_parser.*>
    -<led_controller.*>
    -<pov_engine.*>
    -<web_server.*>
    -<wifi_manager.*>
lib_ldf_mode = off
lib_deps =
board_build.filesystem = littlefs
board_build.partitions = partitions.csv
monitor_speed = 115200

; Test con ESP-IDF puro (sin Arduino)
[env:bornhack2024-espidf]
platform = espressif32
framework = espidf
board = esp32-c3-devkitm-1
build_src_filter =
    +<main_espidf.c>
    -<*.cpp>
board_build.partitions = partitions.csv
monitor_speed = 115200
